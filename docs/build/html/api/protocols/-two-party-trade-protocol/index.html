<HTML>
<HEAD>
<title>TwoPartyTradeProtocol - </title>
<link rel="stylesheet" href="../../style.css">
</HEAD>
<BODY>
<a href="../index.html">protocols</a>&nbsp;/&nbsp;<a href=".">TwoPartyTradeProtocol</a><br/>
<br/>
<h1>TwoPartyTradeProtocol</h1>
<code><span class="keyword">object </span><span class="identifier">TwoPartyTradeProtocol</span></code><br/>
<p>This asset trading protocol implements a "delivery vs payment" type swap. It has two parties (B and S for buyer
and seller) and the following steps:</p>
<ol><li><p>S sends the <a href="../../core/-state-and-ref/index.html">StateAndRef</a> pointing to what they want to sell to B, along with info about the price they require
B to pay. For example this has probably been agreed on an exchange.</p>
</li><li><p>B sends to S a <a href="../../core/-signed-transaction/index.html">SignedTransaction</a> that includes the state as input, Bs cash as input, the state with the new
owner key as output, and any change cash as output. It contains a single signature from B but isnt valid because
it lacks a signature from S authorising movement of the asset.</p>
</li><li><p>S signs it and hands the now finalised SignedWireTransaction back to B.</p>
</li></ol><p>Assuming no malicious termination, they both end the protocol being in posession of a valid, signed transaction
that represents an atomic asset swap.</p>
<p>Note that its the <emph>seller</emph> who initiates contact with the buyer, not vice-versa as you might imagine.</p>
<p>To initiate the protocol, use either the <a href="run-buyer.html">runBuyer</a> or <a href="run-seller.html">runSeller</a> methods, depending on which side of the trade
your node is taking. These methods return a future which will complete once the trade is over and a fully signed
transaction is available: you can either block your thread waiting for the protocol to complete by using
<a href="#">ListenableFuture.get</a> or more usefully, register a callback that will be invoked when the time comes.</p>
<p>To see an example of how to use this class, look at the unit tests.</p>
<br/>
<br/>
<br/>
<br/>
<h3>Types</h3>
<table>
<tbody>
<tr>
<td>
<a href="-buyer/index.html">Buyer</a></td>
<td>
<code><span class="keyword">class </span><span class="identifier">Buyer</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../../core.protocols/-protocol-logic/index.html"><span class="identifier">ProtocolLogic</span></a><span class="symbol">&lt;</span><a href="../../core/-signed-transaction/index.html"><span class="identifier">SignedTransaction</span></a><span class="symbol">&gt;</span></code></td>
</tr>
<tr>
<td>
<a href="-seller/index.html">Seller</a></td>
<td>
<code><span class="keyword">class </span><span class="identifier">Seller</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../../core.protocols/-protocol-logic/index.html"><span class="identifier">ProtocolLogic</span></a><span class="symbol">&lt;</span><a href="../../core/-signed-transaction/index.html"><span class="identifier">SignedTransaction</span></a><span class="symbol">&gt;</span></code></td>
</tr>
<tr>
<td>
<a href="-seller-trade-info/index.html">SellerTradeInfo</a></td>
<td>
<code><span class="keyword">class </span><span class="identifier">SellerTradeInfo</span></code></td>
</tr>
<tr>
<td>
<a href="-signatures-from-seller/index.html">SignaturesFromSeller</a></td>
<td>
<code><span class="keyword">class </span><span class="identifier">SignaturesFromSeller</span></code></td>
</tr>
</tbody>
</table>
<h3>Exceptions</h3>
<table>
<tbody>
<tr>
<td>
<a href="-asset-mismatch-exception/index.html">AssetMismatchException</a></td>
<td>
<code><span class="keyword">class </span><span class="identifier">AssetMismatchException</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Exception.html"><span class="identifier">Exception</span></a></code></td>
</tr>
<tr>
<td>
<a href="-unacceptable-price-exception/index.html">UnacceptablePriceException</a></td>
<td>
<code><span class="keyword">class </span><span class="identifier">UnacceptablePriceException</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Exception.html"><span class="identifier">Exception</span></a></code></td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<table>
<tbody>
<tr>
<td>
<a href="-t-r-a-d-e_-t-o-p-i-c.html">TRADE_TOPIC</a></td>
<td>
<code><span class="keyword">val </span><span class="identifier">TRADE_TOPIC</span><span class="symbol">: </span><span class="identifier">String</span></code></td>
</tr>
</tbody>
</table>
<h3>Functions</h3>
<table>
<tbody>
<tr>
<td>
<a href="run-buyer.html">runBuyer</a></td>
<td>
<code><span class="keyword">fun </span><span class="identifier">runBuyer</span><span class="symbol">(</span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runBuyer(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.Amount, java.lang.Class((core.contracts.OwnableState)), kotlin.Long)/smm">smm</span><span class="symbol">:</span>&nbsp;<a href="../../core.messaging/-state-machine-manager/index.html"><span class="identifier">StateMachineManager</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runBuyer(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.Amount, java.lang.Class((core.contracts.OwnableState)), kotlin.Long)/timestampingAuthority">timestampingAuthority</span><span class="symbol">:</span>&nbsp;<a href="../../core.node/-node-info/index.html"><span class="identifier">NodeInfo</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runBuyer(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.Amount, java.lang.Class((core.contracts.OwnableState)), kotlin.Long)/otherSide">otherSide</span><span class="symbol">:</span>&nbsp;<a href="../../core.messaging/-single-message-recipient.html"><span class="identifier">SingleMessageRecipient</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runBuyer(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.Amount, java.lang.Class((core.contracts.OwnableState)), kotlin.Long)/acceptablePrice">acceptablePrice</span><span class="symbol">:</span>&nbsp;<a href="../../core/-amount/index.html"><span class="identifier">Amount</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runBuyer(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.Amount, java.lang.Class((core.contracts.OwnableState)), kotlin.Long)/typeToBuy">typeToBuy</span><span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html"><span class="identifier">Class</span></a><span class="symbol">&lt;</span><span class="keyword">out</span>&nbsp;<a href="../../core/-ownable-state/index.html"><span class="identifier">OwnableState</span></a><span class="symbol">&gt;</span><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runBuyer(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.Amount, java.lang.Class((core.contracts.OwnableState)), kotlin.Long)/sessionID">sessionID</span><span class="symbol">:</span>&nbsp;<span class="identifier">Long</span><span class="symbol">)</span><span class="symbol">: </span><span class="identifier">&lt;ERROR CLASS&gt;</span><span class="symbol">&lt;</span><a href="../../core/-signed-transaction/index.html"><span class="identifier">SignedTransaction</span></a><span class="symbol">&gt;</span></code></td>
</tr>
<tr>
<td>
<a href="run-seller.html">runSeller</a></td>
<td>
<code><span class="keyword">fun </span><span class="identifier">runSeller</span><span class="symbol">(</span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runSeller(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.StateAndRef((core.contracts.OwnableState)), core.contracts.Amount, java.security.KeyPair, kotlin.Long)/smm">smm</span><span class="symbol">:</span>&nbsp;<a href="../../core.messaging/-state-machine-manager/index.html"><span class="identifier">StateMachineManager</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runSeller(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.StateAndRef((core.contracts.OwnableState)), core.contracts.Amount, java.security.KeyPair, kotlin.Long)/timestampingAuthority">timestampingAuthority</span><span class="symbol">:</span>&nbsp;<a href="../../core.node/-node-info/index.html"><span class="identifier">NodeInfo</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runSeller(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.StateAndRef((core.contracts.OwnableState)), core.contracts.Amount, java.security.KeyPair, kotlin.Long)/otherSide">otherSide</span><span class="symbol">:</span>&nbsp;<a href="../../core.messaging/-single-message-recipient.html"><span class="identifier">SingleMessageRecipient</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runSeller(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.StateAndRef((core.contracts.OwnableState)), core.contracts.Amount, java.security.KeyPair, kotlin.Long)/assetToSell">assetToSell</span><span class="symbol">:</span>&nbsp;<a href="../../core/-state-and-ref/index.html"><span class="identifier">StateAndRef</span></a><span class="symbol">&lt;</span><a href="../../core/-ownable-state/index.html"><span class="identifier">OwnableState</span></a><span class="symbol">&gt;</span><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runSeller(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.StateAndRef((core.contracts.OwnableState)), core.contracts.Amount, java.security.KeyPair, kotlin.Long)/price">price</span><span class="symbol">:</span>&nbsp;<a href="../../core/-amount/index.html"><span class="identifier">Amount</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runSeller(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.StateAndRef((core.contracts.OwnableState)), core.contracts.Amount, java.security.KeyPair, kotlin.Long)/myKeyPair">myKeyPair</span><span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/6/docs/api/java/security/KeyPair.html"><span class="identifier">KeyPair</span></a><span class="symbol">, </span><span class="identifier" id="protocols.TwoPartyTradeProtocol$runSeller(node.services.statemachine.StateMachineManager, core.node.NodeInfo, core.messaging.SingleMessageRecipient, core.contracts.StateAndRef((core.contracts.OwnableState)), core.contracts.Amount, java.security.KeyPair, kotlin.Long)/buyerSessionID">buyerSessionID</span><span class="symbol">:</span>&nbsp;<span class="identifier">Long</span><span class="symbol">)</span><span class="symbol">: </span><span class="identifier">&lt;ERROR CLASS&gt;</span><span class="symbol">&lt;</span><a href="../../core/-signed-transaction/index.html"><span class="identifier">SignedTransaction</span></a><span class="symbol">&gt;</span></code></td>
</tr>
</tbody>
</table>
</BODY>
</HTML>
